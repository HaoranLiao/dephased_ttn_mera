[ERROR 2022-03-09 07:39:07,959] import_thread.py: 88  ImportThread: Connection closed by server.
Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 525, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 532, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 536, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 486, in ray._raylet.execute_task.function_executor
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/_private/function_manager.py", line 563, in actor_method_executor
    return method(__ray_actor, *args, **kwargs)
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/tune/trainable.py", line 178, in train_buffered
    result = self.train()
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/tune/trainable.py", line 237, in train
    result = self.step()
  File "/home/qc_whaley/dephased_ttn_project/uni_ttn/tf2.7/non_distributed_tunning/model.py", line 222, in step
    self.model.run_epoch(batch_size, grad_accumulation=config['data']['grad_accumulation'])
  File "/home/qc_whaley/dephased_ttn_project/uni_ttn/tf2.7/non_distributed_tunning/model.py", line 188, in run_epoch
    self.network.update(train_image_batch, train_label_batch, apply_grads=False)
  File "/home/qc_whaley/dephased_ttn_project/uni_ttn/tf2.7/non_distributed_tunning/network.py", line 93, in update
    grads = tape.gradient(loss, self.var_list)
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/backprop.py", line 1084, in gradient
    flat_grad = imperative_grad.imperative_grad(
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/imperative_grad.py", line 71, in imperative_grad
    return pywrap_tfe.TFE_Py_TapeGradient(
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 1302, in _backward_function_wrapper
    return backward._call_flat(  # pylint: disable=protected-access
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 1963, in _call_flat
    return self._build_call_outputs(self._inference_function.call(
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/function.py", line 591, in call
    outputs = execute.execute(
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/tensorflow/python/eager/execute.py", line 59, in quick_execute
    tensors = pywrap_tfe.TFE_Py_Execute(ctx._handle, device_name, op_name,
tensorflow.python.framework.errors_impl.ResourceExhaustedError:  failed to allocate memory
	 [[{{node gradients/StatefulPartitionedCall_grad/PartitionedCall/gradients/einsum_4/Einsum_grad/Conj}}]]
Hint: If you want to see a list of allocated tensors when OOM happens, add report_tensor_allocations_upon_oom to RunOptions for current allocation info. This isn't available when running in Eager mode.
 [Op:__inference___backward_loss_607_2158]

Function call stack:
__backward_loss_607


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 640, in ray._raylet.task_execution_handler
  File "python/ray/_raylet.pyx", line 488, in ray._raylet.execute_task
  File "python/ray/_raylet.pyx", line 598, in ray._raylet.execute_task
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/_private/utils.py", line 110, in push_error_to_driver
    worker.core_worker.push_error(job_id, error_type, message, time.time())
  File "python/ray/_raylet.pyx", line 1841, in ray._raylet.CoreWorker.push_error
  File "python/ray/_raylet.pyx", line 161, in ray._raylet.check_status
ray.exceptions.RaySystemError: System error: Broken pipe

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 661, in ray._raylet.task_execution_handler
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/_private/utils.py", line 110, in push_error_to_driver
    worker.core_worker.push_error(job_id, error_type, message, time.time())
  File "python/ray/_raylet.pyx", line 1841, in ray._raylet.CoreWorker.push_error
  File "python/ray/_raylet.pyx", line 161, in ray._raylet.check_status
ray.exceptions.RaySystemError: System error: Broken pipe
Exception ignored in: 'ray._raylet.task_execution_handler'
Traceback (most recent call last):
  File "python/ray/_raylet.pyx", line 661, in ray._raylet.task_execution_handler
  File "/home/qc_whaley/anaconda3/envs/tf2.6/lib/python3.9/site-packages/ray/_private/utils.py", line 110, in push_error_to_driver
    worker.core_worker.push_error(job_id, error_type, message, time.time())
  File "python/ray/_raylet.pyx", line 1841, in ray._raylet.CoreWorker.push_error
  File "python/ray/_raylet.pyx", line 161, in ray._raylet.check_status
ray.exceptions.RaySystemError: System error: Broken pipe
